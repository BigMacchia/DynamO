#    DYNAMO:- Event driven molecular dynamics simulator 
#    http://www.marcusbannerman.co.uk/dynamo
#    Copyright (C) 2008  Marcus N Campbell Bannerman <m.bannerman@gmail.com>
#
#    This program is free software: you can redistribute it and/or
#    modify it under the terms of the GNU General Public License
#    version 3 as published by the Free Software Foundation.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License
#    along with this program.  If not, see <http://www.gnu.org/licenses/>.

#using intel-linux ;
#using gcc ;

path-constant BOOST_ROOT : boost/tools/build/v2 ;

import dynamo-tags ;

project	: requirements <variant>debug:<define>DYNAMO_DEBUG 
	  <define>DYNAMO_double_precsision 
	  <variant>release:<define>DYNAMO_Colour
	  <variant>cachegrind:<define>DYNAMO_Cachegrind
	  <variant>release:<runtime-link>static
	  <variant>debug:<define>DYNAMO_DEBUG <link>static
	  #<define>DYNAMO_WallCollDebug
	  #<toolset>gcc:<cxxflags>-ansi
	  #<toolset>gcc:<cxxflags>-pedantic
	  <toolset>gcc:<cxxflags>-Wno-long-long
	  <toolset>gcc:<cxxflags>-Wno-parentheses
	  
	  #This enables the SSE2 instruction set which offers a
	  #15% performance increase
	  <toolset>gcc:<cxxflags>-funroll-loops
	  <toolset>gcc:<cxxflags>-msse2
	  <toolset>gcc:<cxxflags>-mfpmath=sse

	  <tag>@dynamo-tags.naming
	: default-build release
	: build-dir build-dir
	;

#variant PGO : release : <profiling>on <cxxflags>-fprofile-generate <linkflags>-fprofile-generate ;

variant PGO : release : <cxxflags>-fprofile-use <linkflags>-fprofile-use ;

variant cachegrind : <inlining>on <optimization>speed <debug-symbols>on 
	<profiling>off ;

variant massif : <inlining>off <optimization>speed <debug-symbols>on 
	<profiling>off ;

variant colldebug : debug : <define>DYNAMO_CollDebug ;


exe dynareplex_opt 
    : programs/dynareplex_opt.cpp boost//program_options 
    :
    ;

exe dynahist_rw 
    : programs/dynahist_rw.cpp src//dynamo_core/<link>static
    :
    ;

exe dynarun 
    : programs/dynarun.cpp src//dynamo_core/<link>static
    : 
    ;

exe dynamod 
    : programs/dynamod.cpp src//dynamo_core/<link>static
    : 
    ;

install install-bin 
	: dynareplex_opt dynahist_rw dynarun dynamod 
	: <location>bin
	;
	
install install-lib 
	: src//dynamo_core 
	: <location>lib
	;

alias install : install-bin install-lib ;

explicit install install-bin install-lib ;
